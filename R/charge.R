# CHARGE


charge <- function(seq,pH,pKscale){
  # # Divide the amino acid sequence and makes an absolute frequencies table
  aa<-table(factor(prot<-s2c(seq),levels = LETTERS))
  # Set pKscale
  data(pKscales, envir = environment())
  pKs<-pKscales[,pmatch(pKscale,names(pKscales))]
  names(pKs) <- rownames(pKscales)
  # Charge
  charge<-NULL
  charge$cterm <- (-1 /(1+10^(-1*(pH-pKs["cTer"]))))
  charge$nterm <- ( 1 /(1+10^(1*(pH-pKs["nTer"]))))
  charge$carg  <- aa["R"]* ( 1 /(1+10^(1*(pH-pKs["R"]))))
  charge$chis  <- aa["H"]* ( 1 /(1+10^(1*(pH-pKs["H"]))))
  charge$clys  <- aa["K"]* ( 1 /(1+10^(1*(pH-pKs["K"]))))
  charge$casp  <- aa["D"]* (-1 /(1+10^(-1*(pH-pKs["D"]))))
  charge$cglu  <- aa["E"]* (-1 /(1+10^(-1*(pH-pKs["E"]))))
  charge$ccys  <- aa["C"]* (-1 /(1+10^(-1*(pH-pKs["C"]))))
  charge$ctyr  <- aa["Y"]* (-1 /(1+10^(-1*(pH-pKs["Y"]))))
  # Compute the charge and return the value rounded to 2 decimals
  round(sum(as.numeric(charge)),2)
}